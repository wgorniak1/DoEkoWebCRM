"use strict";class DropDown{constructor(n,t,i){if(this.type=t,this.$element=$('select[data-address-id="'+n+'"][data-address="'+t+'"]'),this.parent=i,i!==null){if(i.parent!==null)i.parent.$element.on("change",this._clear(this.$element));i.$element.on("change",this._clear(this.$element));i.$element.on("change",this._refresh(this))}}static TYPE(){return Object.freeze({state:"state",district:"district",commune:"commune",communeType:"communeType"})}static API(){return Object.freeze({state:"/api/v1/address/states",district:"/api/v1/address/states/{stateId}/districts",commune:"/api/v1/address/states/{stateId}/districts/{districtId}/communes"})}get value(){return this.$element.val()}get api(){return""}_clear(n){return function(){n.val("");n.is("select")&&(n.html(""),n.append($("<option><\/option>").val("").html("Wybierz")))}}_refresh(n){return function(){if(n.parent.value!==""){var t=$.getJSON(n.api);t.done(n._fillOptions(n.$element));t.fail(n._handleException(n.type))}}}_fillOptions(n){return function(t){$.each(t,function(t,i){n.append($("<option><\/option>").val(i.id).html(i.text))})}}_handleException(n){return function(t){var i="",r;switch(n){case"state":i="województw";break;case"district":i="powiatów";break;case"commune":i="gmin";break;default:i=""}r="Wystąpił problem podczas pobierania listy "+i;alert(r);console.log(r,t)}}}class DropDownState extends DropDown{get api(){return DropDown.API().state}constructor(n){super(n,DropDown.TYPE().state,null)}}class DropDownDistrict extends DropDown{get api(){return DropDown.API().district.replace("{stateId}",this.parent.value)}constructor(n,t){super(n,DropDown.TYPE().district,t)}}class DropDownCommune extends DropDown{get api(){return DropDown.API().commune.replace("{stateId}",this.parent.parent.value).replace("{districtId}",this.parent.value)}constructor(n,t){super(n,DropDown.TYPE().commune,t);this.$communeType=$('input[data-address-id="'+n+'"][data-address="'+DropDown.TYPE().communeType+'"]');this.parent.parent.$element.on("change",this._clear(this.$communeType));this.parent.$element.on("change",this._clear(this.$communeType));this.$element.on("change",this._clear(this.$communeType));this.$element.on("change",this._refreshType(this))}_refreshType(n){return function(){var t=n.value%10;n.$communeType.val(t)}}}class Address{constructor(n){this.state=new DropDownState(n);this.district=new DropDownDistrict(n,this.state);this.commune=new DropDownCommune(n,this.district)}static createColletion(){var n={};return $("[data-address-id]").map(function(t,i){var r=i.dataset.addressId;n[r+"::"+typeof r]=r}),Object.keys(n).map(function(t){return n[t]}).map(function(n){return new Address(n)})}}var addrCollection=Address.createColletion();