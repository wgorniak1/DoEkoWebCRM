function onTemplateAddClick(){var i=$("#ReportTemplateTable").DataTable(),t=i.row($(this).parents("tr")).data(),n=$("form#TemplateUpload > input[type='file']");n.attr("id",t.key);n.attr("name",t.key);n.click()}function onTemplateInputChange(){var t=$(this),n=t[0].files[0],i;if(n!==undefined&&!["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template"].includes(n.type)){WgTools.alert("Niedozwolony format pliku!",!0,"E");return}i=t.attr("name");UploadTemplate(i,n)}function UploadTemplate(n,t){var i=new FormData,r;i.append("templateName","InspectionSummary");i.append(n,t);r=$.ajax({url:"Create",type:"POST",cache:!1,contentType:!1,processData:!1,data:i,beforeSend:function(){$("#ReportTemplateTable_processing").show()}});r.done(function(){WgTools.alert("Pomyślnie wczytano plik szablonu",!0,"S");var n=$("#ReportTemplateTable").DataTable();n.ajax.reload(null,!1)});r.error(function(n,t,i){WgTools.alert(i,!0,"E")})}function onTemplateDeleteClick(){var n=$("#ReportTemplateTable").DataTable(),t=n.row($(this).parents("tr")).data(),i=$("#TemplateDeleteModal").modal("show");$("body").one("click",".template-delete-confirmed",t.key,DeleteTemplate)}function DeleteTemplate(n){var r=n.data,t=new FormData,i;t.append("templateName","InspectionSummary");t.append("templateSection",r);i=$.ajax({url:"Delete",type:"POST",cache:!1,contentType:!1,processData:!1,data:t});i.done(function(){WgTools.alert("Usunięto szablon",!0,"S");var n=$("#ReportTemplateTable").DataTable();n.ajax.reload(null,!1)});i.error(function(n,t,i){WgTools.alert(i,!0,"E")})}$(document).ready(function(){var n=$("#ReportTemplateTable").DataTable({ajax:{url:"List",dataSrc:"data",rowId:"key"},columns:[{data:"keyText",name:"Szablon - Sekcja"},{data:null,name:"kolumna 2",type:"html",render:function(n){return n.name!==null?'<a href="'+n.url+'" class="wg-link-default">'+n.name+"<\/a>":'<span class="text-danger">Brak<\/span>'}},{data:null,name:"Akcja",orderable:!1,searchable:!1,type:"html",render:function(n){return n.name!==null?'<button class="btn btn-default btn-sm template-delete" type="button"><span class="glyphicon glyphicon-trash"><\/span><\/button>':'<button class="btn btn-default btn-sm template-upload"><span class="glyphicon glyphicon-plus"><\/span><\/button>'}}],stateSave:!0,language:{url:"/js/datatables-language-pl.json"},lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"Wszystkie"]],order:[[0,"asc"]],processing:!0,dom:"<'row'<'col-sm-6'B><'col-sm-6'f>><'row'<'col-sm-12'tr>><'row'<'col-sm-4'l><'col-sm-4'i><'col-sm-4'p>>",buttons:[{extend:"copyHtml5",text:'<span class="glyphicon glyphicon-copy"><\/span>',className:"btn-sm text-primary"},{extend:"csvHtml5",text:'<span class="glyphicon glyphicon-download-alt" title="Export do CSV"><\/span>',className:"btn-sm text-primary"},{extend:"colvis",text:'<span class="glyphicon glyphicon-th-list" title="Pokaż / Ukryj kolumny"><\/span>',className:"btn-sm text-primary"}],select:!1,colReorder:{fixedColumnsRight:1},responsive:!0,fixedHeader:{headerOffset:$("#NavBarMain").outerHeight()},drawCallback:function(){$("div#ReportTemplateTable_processing").addClass("wg-loader");var n=$("div#ReportTemplateTable_filter");$("*",n).addClass("small");n=$("div#ReportTemplateTable_length");$("label",n).addClass("small");$("select",n).addClass("small");n=$("div#ReportTemplateTable_info");n.addClass("small");$("*",n).addClass("small");n=$("div#ReportTemplateTable_paginate");$("ul > li > a",n).addClass("small").attr("style","padding: 5px 10px;")}})});$("body").on("change",".template-input",onTemplateInputChange);$("body").on("click",".template-upload",onTemplateAddClick);$("body").on("click",".template-delete",onTemplateDeleteClick);