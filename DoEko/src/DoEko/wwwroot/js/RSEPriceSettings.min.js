"use strict";function InitializeTaxTab(n){var t="/api/v1/RSERules/Tax?projectId="+n,i=$("#TaxTable").DataTable({ajax:{url:t,dataSrc:""},columnDefs:[{className:"text-right",targets:[3,4,5]}],columns:[{data:null,name:"rseType",title:"Typ OZE",type:"html",render:function(n){return WgEnums.rse.getText(n.surveyType,n.rseType)}},{data:"installationLocalization",name:"installationLocalization",title:"Lokalizacja",render:function(n){return WgEnums.localization.getText(n)}},{data:"buildingPurpose",name:"buildingPurpose",title:"Przezn. Budynku",render:function(n){return WgEnums.building.getText(n)}},{data:"usableAreaMin",name:"usableAreaMin",title:"Powierzchnia Od",type:"html-num",render:function(n,t){switch(t){case"display":var i='<input type="number" class="form-control input-sm wg-area-min" value="'+n+'" step="0.1" min="0.0" max="99999.9" disabled>';return WgTaxTableEdit===!0?i:n;default:return n}}},{data:"usableAreaMax",name:"usableAreaMax",title:"Powierzchnia Do",type:"html-num",render:function(n,t){var i=n===Number.MAX_VALUE?"99999.99":n,r;switch(t){case"display":return r='<input type="number" class="form-control input-sm wg-area-max" value="'+i+'" step="0.1" min="0.0" max="99999.9">',WgTaxTableEdit===!0?r:i;default:return i}}},{data:"vat",name:"vat",title:"VAT",type:"html-num-fmt",render:function(n,t){var i=n+" %",r;switch(t){case"display":return r='<select class="form-control input-sm"><option value="0" '+(n===0?"selected":"")+'>0 %<\/option><option value="5" '+(n===5?"selected":"")+'>5 %<\/option><option value="8" '+(n===8?"selected":"")+'>8 %<\/option><option value="23" '+(n===23?"selected":"")+">23 %<\/option><\/select>",WgTaxTableEdit===!0?r:i;default:return i}}}],stateSave:!1,pagingType:"full",language:WgLanguage,lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"Wszystkie"]],order:[[0,"asc"],[1,"asc"],[2,"asc"],[3,"asc"],[4,"asc"]],processing:!0,dom:"<'row wg-dt-padding'<'col-sm-6'B><'col-sm-6'f>><'row'<'col-sm-12'tr>><'row wg-dt-padding'<'col-sm-4'l><'col-sm-4'i><'col-sm-4'p>>",buttons:[{text:'<span class="text-primary glyphicon glyphicon glyphicon-retweet"><\/span> Przywróć',titleAttr:"Przywróć ustawienia domyślne",className:"btn",action:function(n,i){var u,r;i.table().buttons().disable();u=$("div#TaxTable_processing");u.show();r=$.ajax({url:t,type:"DELETE",data:{},contentType:"application/json"});r.done(function(){i.table().buttons().enable();i.ajax.reload();i.rows().cells().invalidate().render();WgTools.alert("Pomyślnie przywrócono wartości początkowe.",!1,"S")});r.fail(function(){WgTools.alert("Coś poszło nie tak. Proszę skontaktować się z administratorem strony.",!1,"E")})}},{text:'<span class="text-primary glyphicon glyphicon-refresh"><\/span>',titleAttr:"Odśwież zawartość",className:"btn",action:function(n,t){t.ajax.reload();t.rows().cells().invalidate().render()}},{text:'<span class="text-primary glyphicon glyphicon glyphicon-resize-full"><\/span> Podziel',titleAttr:"Podziel przedział powierzchni",className:"btn",action:function(){var i=$("#TaxTable").dataTable().api(),t=i.eq(0).row({selected:!0,page:"current"}),u;if(t!==undefined){var n=t.data(),r=n.usableAreaMax-(n.usableAreaMax-n.usableAreaMin)/2,f=i.row.add({project:null,projectId:n.projectId,surveyType:n.surveyType,rseType:n.rseType,installationLocalization:n.installationLocalization,buildingPurpose:n.buildingPurpose,usableAreaMin:r,usableAreaMax:n.usableAreaMax,vat:n.vat}).invalidate().draw().node();n.usableAreaMax=r;u=t.invalidate().draw().node()}}}],select:"single",responsive:!0,fixedHeader:{headerOffset:$("#NavBarMain").outerHeight()}});$("body").on("change","input.wg-area-max",function(){var n=$(this).parents("tr").next("tr").children("td").find("input.wg-area-min");n.val($(this).val())})}function InitializeNetTab(n){var t="/api/v1/RSERules/Price?projectId="+n,i=$("#NetTable").DataTable({ajax:{url:t,dataSrc:""},columns:[{data:null,name:"rseType",title:"Typ OZE",type:"html",render:function(n){return WgEnums.rse.getText(n.surveyType,n.rseType)}},{data:"unit",name:"unit",title:"Jednostka",type:"html",render:function(n,t){switch(t){case"display":var i='<select class="form-control input-sm" name="unit" ><option value="1" '+(n===1?"selected":"")+'>Moc ostateczna<\/option><option value="2" '+(n===2?"selected":"")+">Liczba zestawów<\/option><\/select>";return WgNetTableEdit===!0?i:n;default:return n}}},{data:"numberMin",name:"numberMin",title:"Od",type:"html-num",render:function(n,t){switch(t){case"display":var i='<input type="number" name="numberMin" class="form-control input-sm" value="'+n+'" step="0.1" min="0.0" max="99999.9" disabled>';return WgNetTableEdit===!0?i:n;default:return n}}},{data:"numberMax",name:"numberMax",title:"Do",type:"html-num",render:function(n,t){n===Number.MAX_VALUE&&(n="999999.99");switch(t){case"display":var i='<input type="number" name="numberMax" class="form-control input-sm" value="'+n+'" step="0.1" min="0.0" max="99999.9">';return WgNetTableEdit===!0?i:n;default:return n}}},{data:"netPrice",name:"netPrice",title:"Cena Netto",type:"html-num",render:function(n,t){switch(t){case"display":var i;return i='<div class="input-group">',i+='<span class="input-group-addon">zł<\/span>',i+='<input type="number" name="netPrice" min="0" max="99999" step="0.01" class="form-control input-sm" value="'+n+'"/>',i+="<\/div>",WgNetTableEdit===!0?i:n;default:return n}}},{data:"multiply",name:"multiply",title:"cena jednostkowa",type:"html",render:function(n,t){switch(t){case"display":var i;return i='<input name="multiply"  class="form-control input-sm checkbox"  data-toggle="toggle" data-on="Tak" data-off="Nie" type="checkbox"',i+=n===!0?" checked />":"/>",WgNetTableEdit===!0?i:n;default:return n}}},],stateSave:!0,pagingType:"full",language:WgLanguage,lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"Wszystkie"]],order:[[0,"asc"],[1,"asc"],[2,"asc"],[3,"asc"]],processing:!0,dom:"<'row wg-dt-padding'<'col-sm-6'B><'col-sm-6'f>><'row'<'col-sm-12'tr>><'row wg-dt-padding'<'col-sm-4'l><'col-sm-4'i><'col-sm-4'p>>",buttons:[{text:'<span class="text-primary glyphicon glyphicon glyphicon-retweet"><\/span> Przywróć',titleAttr:"Przywróć ustawienia domyślne",className:"btn",action:function(n,i){var u,r;i.table().buttons().disable();u=$("div#NetTable_processing");u.show();r=$.ajax({url:t,type:"DELETE",data:{},contentType:"application/json"});r.done(function(){i.table().buttons().enable();i.ajax.reload();i.rows().cells().invalidate().render();WgTools.alert("Pomyślnie przywrócono wartości początkowe.",!1,"S")});r.fail(function(){WgTools.alert("Coś poszło nie tak. Proszę skontaktować się z administratorem strony.",!1,"E")})}},{text:'<span class="text-primary glyphicon glyphicon-refresh"><\/span>',titleAttr:"Odśwież zawartość",className:"btn",action:function(n,t){t.ajax.reload();t.rows().cells().invalidate().render()}},{text:'<span class="text-primary glyphicon glyphicon glyphicon-resize-full"><\/span> Podziel',titleAttr:"Podziel przedział wartości",className:"btn",action:function(n,t){var r=t.row({selected:!0,page:"current"}),e=r.index(),i=r.data(),u=i.numberMax-(i.numberMax-i.numberMin)/2,f=t.row.add({project:null,projectId:i.projectId,surveyType:i.surveyType,rseType:i.rseType,unit:i.unit,numberMin:u,numberMax:i.numberMax,netPrice:i.netPrice,multiply:i.multiply});i.numberMax=u;r.invalidate();f.invalidate();r.draw();f.draw()}}],select:"single",responsive:!0,fixedHeader:{headerOffset:$("#NavBarMain").outerHeight()},drawCallback:function(){var n=$("#NetTable").dataTable().api();$('input[data-toggle="toggle"]').bootstrapToggle()}});$("#NetTable tbody").on("change",'input[name="numberMax"]',function(){var t=$("#NetTable").dataTable().api(),i=t.row($(this).parent("td").parent("tr")),u=i.data(),r=i.index(),n=t.row(r+1);n.data().numberMin=$(this).val();n.invalidate();n.draw()})}class WgRSEEnum{constructor(){this.surveyType=["CO","CWU","EE"];this.rseType=[["","Pompa Ciepła Grunt.","Kocioł na Pellet","Pompa Ciepła Powietrzna"],["","","","Solary","Pompa Ciepła"],["","","","","","Panele Fotowolt."]]}getText(n,t,i){return t===undefined?this.surveyType[n]:i?this.rseType[n][t]:this.rseType[n][t]+" ("+this.surveyType[n]+")"}getId(n,t){for(var u,r=-1,f=-1,i=0;i<this.surveyType.length;i++)this.surveyType[i]===n&&(r=i);if(t===undefined)return r;if(r>=0)for(u=0;u<this.rseType[r].length;u++)this.surveyType[r][i]===n&&(f=i);return f}}class WgLocEnum{constructor(){this._array=["Dach","Grunt","Elewacja"]}getText(n){return this._array[n]}getValue(n){for(var t=0;t<this._array.length;t++)if(this._array[t]===n)return t}}class WgBdgEnum{constructor(){this._array=["Gospodarczy","Mieszkalny"]}getText(n){return this._array[n]}getValue(n){for(var t=0;t<this._array.length;t++)if(this._array[t]===n)return t}}var WgEnums={rse:new WgRSEEnum,localization:new WgLocEnum,building:new WgBdgEnum},WgTaxTableEdit=!0,WgNetTableEdit=!0;$(document).ready(function(){var n=$("#TaxTable").data("projectid");InitializeTaxTab(n);InitializeNetTab(n);$("#TabsContainer ul li a").click(function(){var t=$(this).attr("href"),i=$("table",$(t)).attr("id"),n=$("#"+i).dataTable().api();n.ajax.reload();n.rows().cells().invalidate().render()})});